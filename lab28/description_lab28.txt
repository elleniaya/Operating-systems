 gcc -o lab28 lab28.c -lgen

-> FILE *fp[2];
FILE, запись в который будет стандартным вводом команды.
Родительский процесс пишет в стандартный ввод порождённого через fp[0] и читает его стандартный вывод из fp[1].

p2open, p2close - открывает и закрывает программные каналы для стандартных ввода и вывода команды

-> p2open(3G):
запускает в порожденном процессе shell-команду и устанавливает связь с
этим процессом  через канал.  Он  отличается  от  popen(3S)  тем,  что
предоставляет двунаправленную связь.

p2open(3G) разветвляется (т.е. вызывает fork(2)) и исполняет командную
строку, на  которую  указывает  cmd.  При  возврате,  ptr[0]  содержит
указатель на  FILE, запись в который будет стандартным вводом команды.
ptr[1] содержит  указатель на файл, который может быть использован для
чтения стандартного вывода команды.

успех: pid подпроцесса
неуспех: 0

-> p2close(3G):
p2close(3G) закрывает  оба указателя  на FILE.  Если программист хочет
закрыть  один   из  потоков,  он  может  использовать  для  этой  цели
fclose(3S).  Это  необходимо,  если  команда  является  фильтром,  как
sort(1), который  должен увидеть  конец файла  перед тем,  как  начать
обработку ввода.

успех: статус подпроцесса
неуспех: -1

(!) Как правило, нужно сначала закрывать поток ввода команды вызовом fclose(3C), потом
считывать данные из потока вывода команды и только потом закрывать этот поток вызовом
pclose(3C).
В этой программе важно, что  родитель делает  fclose(3S) для  того файла,  в который он
писал, так  что команда  sort(1) исполняющаяся  в подпроцессе,  увидит конец файла.

